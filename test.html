<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detector de Flora√ß√µes - Multi-Sensor com GRACE e IA</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { color: #2c3e50; text-align: center; }
        .sensor-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
            gap: 15px; 
            margin: 20px 0;
        }
        .sensor-card { 
            padding: 15px; 
            border: 2px solid #bdc3c7; 
            border-radius: 8px; 
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        .sensor-card.selected { 
            border-color: #3498db; 
            background-color: #ecf0f1;
        }
        .sensor-card:hover { transform: translateY(-2px); }
        .form-group { margin: 15px 0; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #34495e; }
        input, select { 
            padding: 10px; 
            width: 100%; 
            box-sizing: border-box; 
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            font-size: 16px;
        }
        button { 
            background: #3498db; 
            color: white; 
            padding: 12px 20px; 
            border: none; 
            border-radius: 5px;
            cursor: pointer; 
            font-size: 16px;
            width: 100%;
            margin: 10px 0;
        }
        button:hover { background: #2980b9; }
        button.secondary { background: #95a5a6; }
        button.secondary:hover { background: #7f8c8d; }
        button.success { background: #27ae60; }
        button.success:hover { background: #219a52; }
        button.warning { background: #f39c12; }
        button.warning:hover { background: #e67e22; }
        
        #result { margin-top: 20px; }
        .status { padding: 10px; border-radius: 5px; margin: 10px 0; }
        .status.demo { background: #fff3cd; color: #856404; }
        .status.real { background: #d4edda; color: #155724; }
        .status.info { background: #d1ecf1; color: #0c5460; }
        .status.warning { background: #fff3cd; color: #856404; }
        .status.ml { background: #e8f4f8; color: #2c3e50; border-left: 4px solid #3498db; }
        
        .sensor-result { 
            background: #f8f9fa; 
            margin: 15px 0; 
            padding: 15px; 
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }
        .event { 
            background: white; 
            margin: 10px 0; 
            padding: 12px; 
            border-radius: 3px;
            border-left: 3px solid #e74c3c;
        }
        .grace-indicators {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }
        .grace-indicator {
            padding: 10px;
            background: #e8f4f8;
            border-radius: 5px;
            text-align: center;
        }
        .ml-prediction {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .risk-level { 
            font-size: 24px; 
            font-weight: bold; 
            margin: 10px 0;
            text-align: center;
        }
        .risk-low { color: #27ae60; }
        .risk-moderate { color: #f39c12; }
        .risk-high { color: #e74c3c; }
        .risk-very-high { color: #c0392b; }
        
        .tab-container {
            margin: 20px 0;
        }
        .tabs {
            display: flex;
            border-bottom: 2px solid #3498db;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background: #ecf0f1;
            margin-right: 5px;
            border-radius: 5px 5px 0 0;
        }
        .tab.active {
            background: #3498db;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 20px;
            background: white;
            border: 1px solid #bdc3c7;
            border-top: none;
        }
        .tab-content.active {
            display: block;
        }
        
        .model-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }
        .model-card {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            text-align: center;
        }
        .progress-bar {
            background: #bdc3c7;
            border-radius: 10px;
            height: 10px;
            margin: 10px 0;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: #27ae60;
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß† Detector de Flora√ß√µes - Multi-Sensor com GRACE e IA</h1>
        
        <div class="status demo" id="statusHeader">
            <strong>Selecione os sensores para an√°lise com Machine Learning</strong>
        </div>
        
        <div class="sensor-grid" id="sensorGrid">
            <div class="sensor-card" data-sensor="landsat" onclick="toggleSensor(this)">
                <h3>üõ∞Ô∏è Landsat</h3>
                <p>Resolu√ß√£o: 30m | NDVI | 16 dias</p>
            </div>
            <div class="sensor-card" data-sensor="modis" onclick="toggleSensor(this)">
                <h3>üåä MODIS</h3>
                <p>Clorofila | SST | Di√°rio</p>
            </div>
            <div class="sensor-card" data-sensor="viirs" onclick="toggleSensor(this)">
                <h3>üåô VIIRS</h3>
                <p>Detec√ß√£o noturna | NDVI | Di√°rio</p>
            </div>
            <div class="sensor-card" data-sensor="smap" onclick="toggleSensor(this)">
                <h3>üíß SMAP</h3>
                <p>Umidade do solo | 3 dias</p>
            </div>
            <div class="sensor-card" data-sensor="grace" onclick="toggleSensor(this)">
                <h3>‚öñÔ∏è GRACE/GRACE-FO</h3>
                <p>Massa de √°gua | Anomalias | Mensal</p>
            </div>
        </div>
        
        <div class="form-group">
            <label>Longitude:</label>
            <input type="number" id="lon" value="-8.8383" step="any">
        </div>
        
        <div class="form-group">
            <label>Latitude:</label>
            <input type="number" id="lat" value="13.2344" step="any">
        </div>
        
        <div class="form-group">
            <label>Data In√≠cio:</label>
            <input type="date" id="start" value="2020-01-01">
        </div>
        
        <div class="form-group">
            <label>Data Fim:</label>
            <input type="date" id="end" value="2024-12-31">
        </div>
        
        <div class="form-group">
            <label>Raio (km):</label>
            <input type="number" id="buffer_km" value="50.0" step="0.1">
        </div>
        
        <div class="form-group">
            <label>Tipo de An√°lise GRACE:</label>
            <select id="grace_analysis">
                <option value="water_mass">Massa de √Ågua Total</option>
                <option value="groundwater">√Ågua Subterr√¢nea</option>
                <option value="soil_moisture">Umidade do Solo</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>
                <input type="checkbox" id="include_ml" checked> 
                Incluir predi√ß√µes de Machine Learning
            </label>
        </div>
        
        <button onclick="analyze()" class="success">üß† Analisar com IA</button>
        <button onclick="trainModels()" class="warning">‚ö° Treinar Modelos de IA</button>
        <button onclick="checkStatus()" class="secondary">üìä Status do Sistema</button>
        <button onclick="checkMLStatus()" class="info">ü§ñ Status da IA</button>
        <button onclick="showDataStats()" class="info">üìä Estat√≠sticas dos Dados</button>
        <div id="result"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000';
        let selectedSensors = ['landsat', 'modis', 'viirs', 'smap', 'grace'];
        
        // Seleciona sensores inicialmente
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.sensor-card').forEach(card => {
                const sensor = card.getAttribute('data-sensor');
                if (selectedSensors.includes(sensor)) {
                    card.classList.add('selected');
                }
            });
        });
        
        function toggleSensor(card) {
            const sensor = card.getAttribute('data-sensor');
            const index = selectedSensors.indexOf(sensor);
            
            if (index > -1) {
                selectedSensors.splice(index, 1);
                card.classList.remove('selected');
            } else {
                selectedSensors.push(sensor);
                card.classList.add('selected');
            }
        }
        
        async function analyze() {
            if (selectedSensors.length === 0) {
                alert('Selecione pelo menos um sensor!');
                return;
            }
            
            const lon = parseFloat(document.getElementById('lon').value);
            const lat = parseFloat(document.getElementById('lat').value);
            const start = document.getElementById('start').value;
            const end = document.getElementById('end').value;
            const buffer_km = parseFloat(document.getElementById('buffer_km').value);
            const grace_analysis = document.getElementById('grace_analysis').value;
            const include_ml = document.getElementById('include_ml').checked;
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="status info">üß† Analisando com IA e m√∫ltiplos sensores incluindo GRACE...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/analyze`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        lon: lon,
                        lat: lat,
                        start: start,
                        end: end,
                        buffer_km: buffer_km,
                        sensors: selectedSensors,
                        grace_analysis: grace_analysis,
                        include_ml_predictions: include_ml
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`Erro HTTP: ${response.status}`);
                }
                
                const data = await response.json();
                displayResults(data);
                
            } catch (error) {
                resultDiv.innerHTML = `<div class="status" style="background:#f8d7da;color:#721c24;">
                    ‚ùå Erro: ${error.message}
                </div>`;
            }
        }
        
        async function trainModels() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="status info">‚ö° Treinando modelos de Machine Learning...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/train-models`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        min_data_points: 50,
                        retrain: true
                    })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    resultDiv.innerHTML = `
                        <div class="status real">
                            <h3>‚úÖ Modelos Treinados com Sucesso!</h3>
                            <p><strong>Acur√°cia da Classifica√ß√£o:</strong> ${(data.classification_accuracy * 100).toFixed(1)}%</p>
                            <p><strong>MSE da Regress√£o:</strong> ${data.regression_mse ? data.regression_mse.toFixed(4) : 'N/A'}</p>
                            <p><strong>Amostras de Treino:</strong> ${data.training_samples}</p>
                            <p><strong>Eventos Positivos:</strong> ${data.positive_events}</p>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="status warning">
                            <h3>‚ö†Ô∏è ${data.status === 'insufficient_data' ? 'Dados Insuficientes' : 'Erro no Treinamento'}</h3>
                            <p>${data.message}</p>
                            <p><strong>Dados dispon√≠veis:</strong> ${data.available_data_points || 0}</p>
                            <p><strong>Dados necess√°rios:</strong> ${data.required_data_points || 50}</p>
                        </div>
                    `;
                }
                
            } catch (error) {
                resultDiv.innerHTML = `<div class="status" style="background:#f8d7da;color:#721c24;">
                    ‚ùå Erro no treinamento: ${error.message}
                </div>`;
            }
        }
        
        async function showDataStats() {
    const resultDiv = document.getElementById('result');
    resultDiv.innerHTML = '<div class="status info">üìä Carregando estat√≠sticas...</div>';
    
    try {
        const response = await fetch(`${API_BASE}/data/stats`);
        const data = await response.json();
        
        let html = `<h3>üìä Estat√≠sticas dos Dados Coletados</h3>`;
        html += `<div class="status real">`;
        html += `<strong>Total de An√°lises:</strong> ${data.total_analyses}<br>`;
        html += `<strong>Total de Eventos Detectados:</strong> ${data.total_events}<br>`;
        html += `<strong>Per√≠odo dos Dados:</strong> ${data.data_period.earliest} √† ${data.data_period.latest}`;
        html += `</div>`;
        
        html += `<h4>üì° Sensores Utilizados</h4>`;
        html += `<div class="sensor-result">`;
        for (const [sensor, count] of Object.entries(data.sensors_count)) {
            html += `<div>${sensor}: ${count} an√°lises</div>`;
        }
        html += `</div>`;
        
        // Bot√µes de a√ß√£o
        html += `<div style="margin-top: 20px;">`;
        html += `<button onclick="exportData()" class="secondary">üì• Exportar Dados (CSV)</button>`;
        html += `<button onclick="listAnalyses()" class="info">üìã Listar An√°lises</button>`;
        html += `</div>`;
        
        resultDiv.innerHTML = html;
    } catch (error) {
        resultDiv.innerHTML = `<div class="status warning">‚ùå Erro: ${error.message}</div>`;
    }
}

async function exportData() {
    try {
        const response = await fetch(`${API_BASE}/data/export`);
        if (response.ok) {
            const blob = await response.blob();
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `bloom_data_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }
    } catch (error) {
        alert(`Erro ao exportar: ${error.message}`);
    }
}

        async function checkStatus() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="status info">üì° Verificando status do sistema...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/health`);
                const data = await response.json();
                
                resultDiv.innerHTML = `
                    <h3>üìä Status do Sistema Multi-Sensor com IA</h3>
                    <div class="status ${data.earth_engine.working ? 'real' : 'demo'}">
                        üåç <strong>Earth Engine:</strong> ${data.earth_engine.working ? '‚úÖ CONECTADO' : 'üî¨ MODO DEMO'}
                    </div>
                    <div class="status ${data.ml_model.is_trained ? 'real' : 'warning'}">
                        ü§ñ <strong>Machine Learning:</strong> ${data.ml_model.is_trained ? '‚úÖ MODELO TREINADO' : '‚ö†Ô∏è PRECISA TREINAR'}
                    </div>
                    <div class="sensor-result">
                        <strong>üì° Sensores Dispon√≠veis:</strong><br>
                        ${data.sensors.map(sensor => `‚Ä¢ ${sensor}`).join('<br>')}
                    </div>
                    <div class="model-status">
                        <div class="model-card">
                            <strong>Modelos Treinados</strong><br>
                            ${data.ml_model.trained_models.length} modelos
                        </div>
                        <div class="model-card">
                            <strong>Pontos de Dados</strong><br>
                            ${data.ml_model.training_data_points} pontos
                        </div>
                    </div>
                `;
                
            } catch (error) {
                resultDiv.innerHTML = `<div class="status" style="background:#f8d7da;color:#721c24;">
                    ‚ùå Erro ao verificar status: ${error.message}
                </div>`;
            }
        }
        
        async function checkMLStatus() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="status info">ü§ñ Verificando status da IA...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/ml-status`);
                const data = await response.json();
                
                let modelsHtml = '';
                if (data.model_metadata) {
                    for (const [modelName, metadata] of Object.entries(data.model_metadata)) {
                        modelsHtml += `
                            <div class="model-card">
                                <strong>${modelName}</strong><br>
                                Tipo: ${metadata.type}<br>
                                ${metadata.type === 'classification' ? `Acur√°cia: ${(metadata.accuracy * 100).toFixed(1)}%` : `MSE: ${metadata.mse.toFixed(4)}`}<br>
                                Features: ${metadata.features_count}<br>
                                Treinado: ${new Date(metadata.trained_at).toLocaleDateString()}
                            </div>
                        `;
                    }
                }
                
                resultDiv.innerHTML = `
                    <h3>ü§ñ Status do Modelo de Machine Learning</h3>
                    <div class="status ${data.is_trained ? 'real' : 'warning'}">
                        ${data.is_trained ? '‚úÖ MODELO TREINADO' : '‚ö†Ô∏è AGUARDANDO TREINAMENTO'}
                    </div>
                    <div class="model-status">
                        <div class="model-card">
                            <strong>Treinado</strong><br>
                            ${data.is_trained ? '‚úÖ Sim' : '‚ùå N√£o'}
                        </div>
                        <div class="model-card">
                            <strong>Modelos</strong><br>
                            ${data.trained_models.length} modelos
                        </div>
                        <div class="model-card">
                            <strong>Dados</strong><br>
                            ${data.training_data_points} pontos
                        </div>
                    </div>
                    <div class="model-status">
                        ${modelsHtml}
                    </div>
                `;
                
            } catch (error) {
                resultDiv.innerHTML = `<div class="status" style="background:#f8d7da;color:#721c24;">
                    ‚ùå Erro ao verificar status da IA: ${error.message}
                </div>`;
            }
        }
        
        function displayResults(data) {
            const resultDiv = document.getElementById('result');
            
            let html = `
                <h3>üß† Resultados Multi-Sensor com GRACE e IA</h3>
                <div class="tab-container">
                    <div class="tabs">
                        <div class="tab active" onclick="switchTab('overview')">Vis√£o Geral</div>
                        <div class="tab" onclick="switchTab('sensors')">Sensores</div>
                        <div class="tab" onclick="switchTab('events')">Eventos</div>
                        ${data.ml_predictions ? '<div class="tab" onclick="switchTab(\'ml\')">ü§ñ Predi√ß√µes IA</div>' : ''}
                    </div>
                    
                    <div id="overview" class="tab-content active">
            `;
            
            // Status do sistema
            const statusHeader = document.getElementById('statusHeader');
            if (data.earth_engine_status.working) {
                statusHeader.className = 'status real';
                statusHeader.innerHTML = '<strong>‚úÖ Earth Engine REAL:</strong> Dados de sat√©lite em tempo real com IA';
            } else {
                statusHeader.className = 'status demo';
                statusHeader.innerHTML = '<strong>üî¨ Modo Demonstra√ß√£o:</strong> Dados simulados com IA';
            }
            
            html += `<div class="status ${data.earth_engine_status.working ? 'real' : 'demo'}">`;
            html += `üõ∞Ô∏è <strong>Sensores usados:</strong> ${data.sensors_used.join(', ').toUpperCase()}`;
            html += ` | üìä <strong>Eventos detectados:</strong> ${data.summary.total_events}`;
            if (data.ml_predictions && data.ml_predictions.bloom_risk_probability) {
                html += ` | ü§ñ <strong>Risco IA:</strong> ${(data.ml_predictions.bloom_risk_probability * 100).toFixed(1)}%`;
            }
            html += `</div>`;
            
            // Predi√ß√µes de ML
            if (data.ml_predictions && !data.ml_predictions.error) {
                const riskLevel = data.ml_predictions.risk_level.toLowerCase().replace(' ', '-');
                html += `
                    <div class="ml-prediction">
                        <h4>üß† Predi√ß√£o de Machine Learning</h4>
                        <div class="risk-level ${riskLevel}">
                            Probabilidade de Flora√ß√£o: ${(data.ml_predictions.bloom_risk_probability * 100).toFixed(1)}%
                        </div>
                        <div style="text-align: center; font-size: 20px; margin: 10px 0;">
                            N√≠vel de Risco: <strong>${data.ml_predictions.risk_level}</strong>
                        </div>
                        ${data.ml_predictions.predicted_intensity ? `
                            <div style="text-align: center;">
                                Intensidade Prevista: <strong>${data.ml_predictions.intensity_level}</strong>
                                (${data.ml_predictions.predicted_intensity.toFixed(3)})
                            </div>
                        ` : ''}
                        <div style="text-align: center; margin-top: 10px;">
                            Previs√£o para: ${data.ml_predictions.prediction_date}
                        </div>
                    </div>
                `;
            } else if (data.ml_predictions && data.ml_predictions.error) {
                html += `
                    <div class="status warning">
                        <strong>‚ö†Ô∏è IA N√£o Dispon√≠vel:</strong> ${data.ml_predictions.message || data.ml_predictions.error}
                    </div>
                `;
            }
            
            html += `</div>`; // Fecha overview
            
            // Tab Sensores
            html += `
                <div id="sensors" class="tab-content">
                    <h4>üì° Dados dos Sensores</h4>
            `;
            
            // Dados GRACE espec√≠ficos
            if (data.data.grace) {
                html += `<div class="sensor-result">`;
                html += `<h5>‚öñÔ∏è GRACE/GRACE-FO - ${data.data.grace.analysis_type}</h5>`;
                
                html += `<div class="grace-indicators">`;
                html += `<div class="grace-indicator">
                    <strong>Anomalia Atual:</strong><br>
                    ${data.data.grace.current_anomaly ? data.data.grace.current_anomaly.toFixed(2) + ' cm' : 'N/A'}
                </div>`;
                html += `<div class="grace-indicator">
                    <strong>Tend√™ncia:</strong><br>
                    ${data.data.grace.trend ? data.data.grace.trend.toFixed(3) + ' cm/ano' : 'N/A'}
                </div>`;
                html += `<div class="grace-indicator">
                    <strong>Confian√ßa:</strong><br>
                    ${data.data.grace.confidence ? (data.data.grace.confidence * 100).toFixed(1) + '%' : 'N/A'}
                </div>`;
                html += `</div>`;
                
                if (data.data.grace.interpretation) {
                    html += `<p><strong>Interpreta√ß√£o:</strong> ${data.data.grace.interpretation}</p>`;
                }
                html += `</div>`;
            }
            
            // Outros sensores
            for (const [sensor, sensorData] of Object.entries(data.data)) {
                if (sensor === 'grace') continue;
                
                html += `<div class="sensor-result">`;
                html += `<h5>${getSensorIcon(sensor)} ${sensor.toUpperCase()} (${sensorData.length} observa√ß√µes)</h5>`;
                
                if (sensorData && sensorData.length > 0) {
                    const sample = sensorData.slice(0, 3);
                    html += `<div style="font-size: 12px; margin-top: 10px;">`;
                    sample.forEach(point => {
                        html += `<div>${point.date}: ${formatSensorData(point, sensor)}</div>`;
                    });
                    if (sensorData.length > 3) {
                        html += `<div>... mais ${sensorData.length - 3} pontos</div>`;
                    }
                    html += `</div>`;
                }
                html += `</div>`;
            }
            
            html += `</div>`; // Fecha sensors
            
            // Tab Eventos
            html += `
                <div id="events" class="tab-content">
                    <h4>üåä Eventos Detectados</h4>
            `;
            
            if (data.events && data.events.length > 0) {
                data.events.forEach((event, index) => {
                    html += `<div class="event">
                        <strong>Evento ${index + 1} (${event.sensor})</strong><br>
                        <strong>Tipo:</strong> ${event.type}<br>
                        <strong>Per√≠odo:</strong> ${event.start} a ${event.end}<br>
                        <strong>Dura√ß√£o:</strong> ${event.duration_days} dias<br>
                        <strong>Severidade:</strong> ${event.severity}<br>
                        <strong>Confian√ßa:</strong> ${(event.confidence * 100).toFixed(1)}%
                    </div>`;
                });
            } else {
                html += `<div class="sensor-result">Nenhum evento significativo detectado.</div>`;
            }
            html += `</div>`; // Fecha events
            
            // Tab ML
            if (data.ml_predictions) {
                html += `
                    <div id="ml" class="tab-content">
                        <h4>ü§ñ Detalhes da Predi√ß√£o de IA</h4>
                        <div class="status ml">
                            <strong>Status do Modelo:</strong><br>
                            ${data.ml_model_status ? JSON.stringify(data.ml_model_status, null, 2) : 'Informa√ß√µes n√£o dispon√≠veis'}
                        </div>
                    </div>
                `;
            }
            
            html += `</div>`; // Fecha tab-container
            
            resultDiv.innerHTML = html;
        }
        
        function switchTab(tabName) {
            // Esconde todas as tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Mostra a tab selecionada
            document.getElementById(tabName).classList.add('active');
            event.currentTarget.classList.add('active');
        }
        
        function getSensorIcon(sensor) {
            const icons = {
                'landsat': 'üõ∞Ô∏è',
                'modis': 'üåä', 
                'viirs': 'üåô',
                'smap': 'üíß',
                'grace': '‚öñÔ∏è'
            };
            return icons[sensor] || 'üì°';
        }
        
        function formatSensorData(point, sensor) {
            if (sensor === 'landsat') {
                return `NDVI: ${point.NDVI ? point.NDVI.toFixed(3) : 'N/A'}`;
            } else if (sensor === 'modis') {
                return `Clorofila: ${point.chlorophyll ? point.chlorophyll.toFixed(3) : 'N/A'}, SST: ${point.sst ? point.sst.toFixed(1) + '¬∞C' : 'N/A'}`;
            } else if (sensor === 'viirs') {
                return `NDVI: ${point.NDVI ? point.NDVI.toFixed(3) : 'N/A'}`;
            } else if (sensor === 'smap') {
                return `Umidade: ${point.soil_moisture ? (point.soil_moisture * 100).toFixed(1) + '%' : 'N/A'}`;
            }
            return JSON.stringify(point);
        }
    </script>
</body>
</html>